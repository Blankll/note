# java内存模型

- jvm内存结构

  - Method Area (方法区)[运行时数据区在所有线程间共享]
    - 已经加载的static变量
    - 已经加载的类信息
    - 已经加载的常量信息
    - 永久引用
  - Heap (堆)[运行时数据区在所有线程间共享]
    - 实例对象，数组 => 运行时动态分配，失去引用后会被GC回收
  - Java Stack (java栈)[运行时数据区私有]
    - 基本数据类型
    - 对象引用
    - 编译时确定大小，不会再改变
  - Native Method Stack (本地方法栈)[运行时数据区私有]
    - 本地方法相关的栈
  - Program Counter Register (程序计数器)[运行时数据区私有]
    - 保存当前线程所执行的行数等信息

- java内存模型 java memory model

  - jmm是一组规范，目的在于更方便的开发多线程程序
  - volatile synchronized Lock等的原理都是JMM
  - 重排序
  - 可见性
  - 原子性

- java对象模型

  java对象再jvm中的存储结构，即java对象自身的存储模型



## 重排序

在线程1内部的两行代码的实际执行顺序和java文件中的顺序不一致，代码指令并不是严格按照代码语句顺序执行的，他们的顺序被改变， 发生了重排序

## 可见性

cpu有多级缓存，导致读数据过期

volatile将修改刷新到内存中

## 原子性